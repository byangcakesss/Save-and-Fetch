<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Google Sheets Web App</title>
</head>
<style>
    body{
        background-color: blueviolet;
        text-align: center;
        padding: 15%;
    }
</style>
<body>

  <h2>Google Sheets Integration</h2>

  <button id="saveBtn">Save Data</button>
  <button id="fetchBtn">Fetch Data</button>

  <h3>Stored Data (check console or see below):</h3>
  <pre id="output"></pre>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbypne8OjfMV5bxHuIQ5hcpFRA2Py5ELBdxtR-4TjPwuTg-iQhdUdOYSnqpQ3xhmI9z5WQ/exec";

    // Save hardcoded data to Google Sheet
    document.getElementById("saveBtn").addEventListener("click", () => {
      const payload = { name: "John Doe", score: 95 };

      fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify(payload)
      })
      .then(res => res.text())
      .then(msg => alert(msg))
      .catch(err => {
        console.error("POST error:", err);
        alert("Failed to save data.");
      });
    });

    // Fetch and display data from Google Sheet
    document.getElementById("fetchBtn").addEventListener("click", () => {
      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          console.log(data); // Show in console
          document.getElementById("output").textContent = JSON.stringify(data, null, 2); // Show in HTML
        })
        .catch(err => {
          console.error("GET error:", err);
          alert("Failed to fetch data.");
        });
    });
  </script>

</body>
</html>
